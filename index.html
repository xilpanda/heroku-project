<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline Manager</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Welcome to Pipeline Manager</h1>
    <button onclick="connectToPipelineManager()">Connect to Pipeline Manager</button>
    
    <!-- Dodajemo sekciju za tabelu -->
    <div>
        <h2>Existing Pipelines</h2>
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>Pipeline ID</th>
                    <th>Task Name</th>
                    <th>Repo Name</th>
                    <th>Branch</th>
                    <th>Trigger Time</th>
                    <th>Status</th>
                    <th>Last Execution</th>
                    <th>Duration</th>
                </tr>
            </thead>
            <tbody id="pipelineTableBody">
                <!-- Podaci će biti dodati dinamički ovde -->
            </tbody>
        </table>
    </div>

    <script src="script.js"></script>
</body>
</html>
<script>
    // URL vašeg API endpoint-a
    const apiUrl = "https://55b1-31-223-131-30.ngrok-free.app/pipelines";

    // Funkcija za preuzimanje podataka sa API-ja
    async function fetchPipelines() {
        try {
            const response = await fetch(apiUrl);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            console.log(data); // Proverite podatke u konzoli

            // Funkcija za prikazivanje podataka u tabeli
            displayPipelines(data);
        } catch (error) {
            console.error("Error fetching pipelines:", error);
        }
    }

    // Funkcija za prikazivanje podataka u tabeli
    function displayPipelines(pipelines) {
        const tableBody = document.getElementById("pipelineTableBody");
        tableBody.innerHTML = ""; // Očistite prethodne podatke

        pipelines.forEach((pipeline) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${pipeline.id || "N/A"}</td>
                <td>${pipeline.name || "N/A"}</td>
                <td>${pipeline.repo || "N/A"}</td>
                <td>${pipeline.branch || "N/A"}</td>
                <td>${pipeline.triggerTime || "N/A"}</td>
                <td>${pipeline.status || "N/A"}</td>
                <td>${pipeline.lastExecution || "N/A"}</td>
                <td>${pipeline.duration || "N/A"}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Automatski pozovite funkciju za preuzimanje podataka kada se stranica učita
    document.addEventListener("DOMContentLoaded", fetchPipelines);
</script>
